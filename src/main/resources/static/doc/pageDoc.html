<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>接口文档</title>
<link rel="icon" href="favicon.ico" type="image/ico">
<meta name="keywords" content="接口规范">
<meta name="description" content="接口规范">
<meta name="author" content="yinqi">
<link href="../admin/css/bootstrap.min.css" rel="stylesheet">
<link href="../admin/css/materialdesignicons.min.css" rel="stylesheet">
<link href="../admin/css/style.min.css" rel="stylesheet">
<style>
  html,body{
    background: white;
  }
  .api-method{
    font-size: 1.2em;display: inline-block;line-height: 35px;background: #49cc90;color:white;text-align: center;width:80px;border-radius:5px;margin-right:30px;
  }
  .api-url{
    line-height: 35px;
  }
  .api-name-css{
    font-size: 1.2em;font-weight: bold;margin-bottom:10px;
    border-left:4px solid #00ab6d;
    padding-left: 10px;
  }
  .api-name-title{
    font-size: 1.2em;font-weight: bold;margin-bottom:10px;
  }
  .api-bg{
    background: rgba(73,204,144,.1);
    margin-bottom:10px;
  }
  .level-1{
    padding-left:2em !important;
  }
  .level-2{
    padding-left:4em !important;
  }
  .level-3{
    padding-left:6em !important;
  }
  .level-4{
    padding-left:8em !important;
  }
  .level-5{
    padding-left:10em !important;
  }
  .tree-exp{
    display: inline-block;cursor: pointer;border:1px solid #ddd;width:20px;text-align: center;margin-right: 5px;color:#096dd9;border-color:#096dd9;border-radius:2px;
  }
  .param-exp{
    display: inline-block;cursor: pointer;border:1px solid #ddd;width:25px;text-align: center;margin-right: 5px;color:#096dd9;border-color:#096dd9;border-radius:2px;
    margin-left:10px;
  }
  .example{
    margin-top:10px;
    margin-bottom:10px;
    height:300px !important;
  }
  #cloneBody{
    display:none;
  }
</style>
</head>

<body>
<div class="container-fluid p-t-15">
  <ul id="myTabs" class="nav nav-tabs" role="tablist">
    <li class="active"><a href="#home" id="home-tab" role="tab" data-toggle="tab">金庸</a></li>
    <li><a href="#profile" role="tab" id="profile-tab" data-toggle="tab">古龙</a></li>
  </ul>
  <div id="myTabContent" class="tab-content">
    <div class="tab-pane fade active in" id="home">
      <p>原名查良镛，1924年3月10日生于浙江省海宁市，1948年移居香港。当代知名武侠小说作家、新闻学家、企业家、政治评论家、社会活动家，“香港四大才子”之一。1944年考入重庆中央政治大学外交系。1946年秋，金庸进入上海《大公报》任国际电讯翻译。1948年，毕业于上海东吴大学法学院。1952年调入《新晚报》编辑副刊，并写出《绝代佳人》、《兰花花》等电影剧本。1959年，金庸等人于香港创办《明报》。</p>
    </div>
    <div class="tab-pane fade" id="profile">
      <p>原名熊耀华，籍贯江西，汉族。1938年6月7日生于香港。著名武侠小说家，新派武侠小说泰斗，与金庸、梁羽生并称为中国武侠小说三大宗师。代表作有《多情剑客无情剑》、《绝代双骄》、《英雄无泪》等。古龙把武侠小说引入了经典文学的殿堂，将戏剧、推理、诗歌等元素带入传统武侠，又将自己独特的人生哲学融入其中，使中外经典镕铸一炉，开创了近代武侠小说新纪元，将武侠文学推上了一个新的高峰。</p>
    </div>
  </div>

  <div id="cloneBody">
    <!--
    <div class="api-name api-name-title">分页查询</div>
    -->
    <div class="api-bg">
      <span class="api-method">POST</span>
      <span class="api-url">/admin/crud/query</span>
    </div>
    <div class="api-name-css">请求示例<span class="param-exp param-open">-</span></div>
    <textarea class="form-control example paramsExample" ></textarea>
    <div class="api-name-css">请求参数<span class="param-exp param-open">-</span></div>
    <table class="table table-hover params">
      <thead>
      <tr>
        <th width="200">参数名称</th>
        <th width="200">参数说明</th>
        <th width="500">备注</th>
      </tr>
      </thead>
      <tbody>
      <tr>
      </tr>

      </tbody>
    </table>
    <div class="api-name-css">返回示例<span class="param-exp param-open">-</span></div>
    <textarea class="form-control example resultExample" ></textarea>
    <div class="api-name-css">返回结果<span class="param-exp param-open">-</span></div>
    <table class="table table-hover result">
      <thead>
      <tr>
        <th width="200">参数名称</th>
        <th width="200">参数说明</th>
        <th width="500">备注</th>
      </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>



</div>

<script type="text/javascript" src="../admin/js/jquery.min.js"></script>

<script type="text/javascript">

  function getUrlParams(key) {
    var url = window.location.search.substr(1);
    if (url == '') {
      return false;
    }
    var paramsArr = url.split('&');
    for (var i = 0; i < paramsArr.length; i++) {
      var combina = paramsArr[i].split("=");
      if (combina[0] == key) {
        return combina[1];
      }
    }
    return null;
  }
  let code = getUrlParams("code");
  $.ajax({
    method:"get",
    url:"/doc/page/"+code,
    dataType:"JSON",
    async:false,
    success:function(data){
      let apis = data.data;
      $("#myTabContent").empty();
      $("#myTabs").empty();
      for(let i=0;i<apis.length;i++){
        let api = apis[i];
        $("#myTabs").append('<li ><a href="#api-'+i+'" id="api-'+i+'-tab" role="tab" data-toggle="tab">'+api.name+'</a></li>');

        let tab = $('<div class="tab-pane fade   " id="api-'+i+'"></div>');
        let cloneBody = $("#cloneBody").clone();
        tab.append(cloneBody);
        cloneBody.removeAttr("id");
        loadTable(api,cloneBody);
        $("#myTabContent").append(tab);
      }

    }
  })

  function loadTable(data,cloneBody){
    cloneBody.find(".api-name").text(data.name);
    cloneBody.find(".api-url").text(data.url);
    cloneBody.find(".api-method").text(data.method);
    let tbody = cloneBody.find(".params tbody");
    tbody.empty();
    let paramExample = {};
    appendParam(tbody,data.params,0,"0",paramExample);
    if(data.method == "get"){
      let paramExampleStr = "";
      for(let key in paramExample){
        if(paramExampleStr == ""){
          paramExampleStr += "?"+key+"=";
        }else{
          paramExampleStr += "&"+key+"=";
        }
      }
      cloneBody.find(".paramsExample").val(paramExampleStr);
    }else{
      cloneBody.find(".paramsExample").val(JSON.stringify(paramExample,null,"\t"));
    }

    tbody = cloneBody.find(".result tbody");
    tbody.empty();
    let resultExample = {};
    appendParam(tbody,data.result,0,"0",resultExample);

    cloneBody.find(".resultExample").val(JSON.stringify(resultExample,null,"\t"));


    cloneBody.find(".tree-exp").click(function(){
      let tr = $(this).parent().parent();
      let tbody = tr.parent();
      let nextTr = tbody.find("tr[treeid|='"+tr.attr("treeid")+"']")
      if($(this).is(".tree-open")){
        $(this).text("+")
        $(this).removeClass("tree-open");
        $(this).addClass("tree-close");

        nextTr.hide();

      }else{
        $(this).text("-")

        $(this).removeClass("tree-close");
        $(this).addClass("tree-open");

        nextTr.show();
      }
      tr.show();
    });
  }

  $(".param-exp").click(function(){
    let next = $(this).parent().next();
    if($(this).is(".param-open")){
      $(this).text("+")
      $(this).removeClass("param-open");
      $(this).addClass("param-close");

      next.hide();

    }else{
      $(this).text("-")

      $(this).removeClass("param-close");
      $(this).addClass("param-open");

      next.show();
    }
  });

  function appendParam(tbody,items,level,prefix,example){
    for(let i=0;i<items.length;i++){
      let item = items[i];
      example[item.name] = "";
      let children = item.children;
      let hasChildren = children && children.length > 0;
      let tr = $('<tr treeid="tree-'+prefix+"-"+i+'" ></tr>');
      let name = hasChildren ? item.name : ("<span style='margin-left:2em;'>"+item.name+"</span>");
      tr.append('<td class="level-'+level+'"  >'+(hasChildren ? '<span class="tree-exp tree-open">-</span>' : '')+name+'</td>');
      tr.append('<td>'+item.label+'</td>');
      tr.append('<td>'+item.remark+'</td>');
      tbody.append(tr);

      if(hasChildren){
        let child = {};
        if(item.type == "json"){
          example[item.name] = child;
        }else{
          example[item.name] = [child];
        }

        appendParam(tbody,children,level+1,prefix + "-"+i,child);
      }
    }
  }

</script>


<script type="text/javascript" src="../admin/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../admin/js/main.min.js"></script>


<script>
    $("#myTabs li").eq(0).find("a").click();
</script>
</body>
</html>
